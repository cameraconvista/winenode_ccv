Ecco il riepilogo finale, chiaro e operativo, su come devono funzionare le due funzioni ğŸ§¹ Pulisci e âœ¨ Ottimizza per compilare correttamente il modale Gestione Vini (ConfermaVino):

ğŸ§¹ PULISCI (handleClean())
Obiettivo: preparare il testo grezzo in un formato leggibile e standardizzato, senza interpretarlo, per permettere allâ€™ottimizzazione di lavorare bene.

ğŸ”§ Cosa fa:
Tutto in MAIUSCOLO

Rimuove caratteri inutili: parentesi, slash, trattini, punti, ecc.
(âš ï¸ Mantiene â‚¬ e virgolette)

Riconosce ed evidenzia blocchi principali:

Nome vino

Prezzo

Anno (se presente nel testo)

Tipologia (ROSSO, BIANCO, ecc.)

Provenienza (regione o stato)

Divide correttamente le righe (ogni vino su una riga)

Sistema spazi: rimuove doppi spazi e spazi finali

Format finale per ogni riga:

css
Copia
Modifica
NOME VINO â€“ â‚¬ PREZZO â€“ [ALTRE INFO SE PRESENTI]
âœ¨ OTTIMIZZA (handleOptimizeStep())
Obiettivo: arricchire ogni riga del testo giÃ  pulito compilando automaticamente i campi del modale ConfermaVino.

ğŸ”§ Cosa fa:
Per ogni riga del testo:

Mantiene tutto ciÃ² che Ã¨ giÃ  presente nel testo (prezzo, anno, produttore ecc.)

NON modifica mai:

Prezzo

Anno (lo legge solo dal testo)

Nome completo se giÃ  presente

Aggiunge SOLO se mancante:

ğŸ· Produttore â†’ solo se non giÃ  presente

ğŸ“ Provenienza â†’ se non giÃ  scritta

ğŸ· Tipologia (Categoria) â†’ dedotta da parole chiave

ğŸ’° Costo stimato â†’ opzionale se mancante

Valida i dati aggiunti:

Il produttore non puÃ² essere â€œROSSOâ€, â€œCDSCâ€ ecc.

La categoria deve essere una tra quelle mappate con Supabase

Non unisce righe, non riscrive tutto:
â¤ ogni riga in input produce una riga migliorata e riconoscibile.

âœ… Risultato atteso nel Modale ConfermaVino:
Campo	Fonte
Nome Vino	Da input + pulizia
Anno	Solo se presente nel testo (non cercato online)
Categoria	Deducibile da parole chiave (ROSSO â†’ ROSSI, ecc.)
Costo	Calcolato solo se non presente
Prezzo	Preso sempre dal testo
Produttore	Aggiunto solo se non giÃ  presente
Provenienza	Inserita solo se assente

